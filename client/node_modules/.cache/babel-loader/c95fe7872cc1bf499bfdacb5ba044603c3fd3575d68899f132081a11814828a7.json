{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\48664\\\\Desktop\\\\project\\\\client\\\\src\\\\components\\\\ContentComponents\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useTransition } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { io } from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Chat(_ref) {\n  _s();\n  let {\n    data\n  } = _ref;\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const chatRef = useRef(null);\n  const socket = useRef(null);\n  const currentUser = data.username;\n  const {\n    t\n  } = useTranslation();\n  // Automatycznie przewijaj czat na dół po każdej nowej wiadomości\n  useEffect(() => {\n    // połącz z backendem WebSocket\n    socket.current = io('http://localhost:8080');\n    //pobierz historię czatu\n    socket.current.on('chatHistory', history => {\n      setMessages(history);\n    });\n\n    // Obsługa odbioru nowej wiadomości\n    socket.current.on('newMessage', message => {\n      setMessages(prevMessages => [...prevMessages, message]);\n    });\n    return () => {\n      socket.current.disconnect(); //rozłącz websocket przy odmontowaniu\n    };\n  }, []);\n  useEffect(() => {\n    var _chatRef$current;\n    (_chatRef$current = chatRef.current) === null || _chatRef$current === void 0 ? void 0 : _chatRef$current.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  const handleSendMessage = () => {\n    if (newMessage.trim()) {\n      const message = {\n        id: Date.now(),\n        userId: data._id,\n        text: newMessage,\n        sender: currentUser,\n        // wiadomość od użytkownika<-wysyłaćtoken\n        isAdmin: data.isAdmin\n      };\n      socket.current.emit('newMessage', message);\n      setNewMessage('');\n    }\n  };\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      handleSendMessage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-full\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-grow overflow-y-auto space-y-2 p-5\",\n      children: [messages.map(message => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `p-2 max-w-xs rounded-lg break-words ${message.sender === currentUser ? 'ml-auto bg-maincolor1 text-white bg-opacity-70' : 'mr-auto bg-maincolor2 text-white bg-opacity-70'} &{\n              message.isAdmin ? 'border-2 border-maincolor5' : ''\n            }`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: `font-semibold ${message.isAdmin ? 'text-maincolor5' : 'text-white'}`,\n          children: [message.sender, \":\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 13\n        }, this), \" \", message.text]\n      }, message.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: chatRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex flex-col bg-gray-900 p-4 rounded-lg\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-4 flex\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"flex-grow p-2 rounded-l-lg bg-gray-800 text-white border border-gray-700 focus:outline-none\",\n          placeholder: t('typeMessage'),\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value),\n          onKeyDown: handleKeyPress\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendMessage,\n          className: \"bg-blue-600 text-white p-2 rounded-r-lg hover:bg-blue-700\",\n          children: t('send')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"nQ255teHv9o6+nPg+SNVeJHnJgs=\", false, function () {\n  return [useTranslation];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useTransition","useTranslation","io","Chat","data","messages","setMessages","newMessage","setNewMessage","chatRef","socket","currentUser","username","t","current","on","history","message","prevMessages","disconnect","scrollIntoView","behavior","handleSendMessage","trim","id","Date","now","userId","_id","text","sender","isAdmin","emit","handleKeyPress","e","key","map","target","value"],"sources":["C:/Users/48664/Desktop/project/client/src/components/ContentComponents/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useTransition } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { io } from 'socket.io-client';\r\n\r\nfunction Chat({data}) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const chatRef = useRef(null);\r\n  const socket = useRef(null);\r\n  const currentUser = data.username;\r\n  const { t } = useTranslation();\r\n  // Automatycznie przewijaj czat na dół po każdej nowej wiadomości\r\n  useEffect(() => {\r\n    // połącz z backendem WebSocket\r\n    socket.current = io('http://localhost:8080');\r\n    //pobierz historię czatu\r\n    socket.current.on('chatHistory', (history) => {\r\n      setMessages(history);\r\n    });\r\n\r\n    // Obsługa odbioru nowej wiadomości\r\n    socket.current.on('newMessage',(message) =>\r\n    {\r\n      setMessages((prevMessages) => [...prevMessages, message]);\r\n    });\r\n\r\n    return () => {\r\n      socket.current.disconnect(); //rozłącz websocket przy odmontowaniu\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    chatRef.current?.scrollIntoView({ behavior: 'smooth'});\r\n  }, [messages]);\r\n\r\n  const handleSendMessage = () => {\r\n    if (newMessage.trim()) {\r\n      const message = {\r\n        id: Date.now(),\r\n        userId: data._id,\r\n        text: newMessage,\r\n        sender: currentUser, // wiadomość od użytkownika<-wysyłaćtoken\r\n        isAdmin: data.isAdmin,\r\n      };\r\n      socket.current.emit('newMessage',message);\r\n      setNewMessage('');\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') {\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full\">\r\n      <div className=\"flex-grow overflow-y-auto space-y-2 p-5\">\r\n        {messages.map((message) => (\r\n          <div\r\n            key={message.id}\r\n            className={`p-2 max-w-xs rounded-lg break-words ${\r\n              message.sender === currentUser\r\n                ? 'ml-auto bg-maincolor1 text-white bg-opacity-70'\r\n                : 'mr-auto bg-maincolor2 text-white bg-opacity-70'\r\n                } &{\r\n              message.isAdmin ? 'border-2 border-maincolor5' : ''\r\n            }`}\r\n          >\r\n            <span \r\n              className={`font-semibold ${\r\n                message.isAdmin ? 'text-maincolor5' :'text-white'\r\n              }`}\r\n              >\r\n                {message.sender}:\r\n            </span>{\" \"}\r\n            {message.text}\r\n          </div>\r\n        ))}\r\n\r\n        <div ref={chatRef} />\r\n      </div>\r\n\r\n        {/* Pole wejściowe i przycisk wysyłania */}\r\n      <div className=\"flex flex-col bg-gray-900 p-4 rounded-lg\">\r\n        <div className=\"mt-4 flex\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"flex-grow p-2 rounded-l-lg bg-gray-800 text-white border border-gray-700 focus:outline-none\"\r\n            placeholder={t('typeMessage')}\r\n            value={newMessage}\r\n            onChange={(e) => setNewMessage(e.target.value)}\r\n            onKeyDown={handleKeyPress}\r\n          />\r\n          <button\r\n            onClick={handleSendMessage}\r\n            className=\"bg-blue-600 text-white p-2 rounded-r-lg hover:bg-blue-700\"\r\n          >\r\n            {t('send')}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}